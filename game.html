<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Name - UMD Harbor Hopper Game</title>
    
    <!-- CONSOLIDATED STYLESHEET (CSS) -->
    <style>
        /* ===== VARIABLES (From style.css) ===== */
        :root {
            --primary-color: #7a0019;    /* UMD Maroon */
            --secondary-color: #ffcc33;  /* UMD Gold */
            --text-color: #333;
            --background-color: #fff;
            --gray: #f4f4f4;
        }

        /* ===== RESET & BASE STYLES (From style.css) ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, Helvetica, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
        }

        /* ===== NAVIGATION (From style.css) ===== */
        nav {
            background-color: var(--primary-color);
            padding: 1rem;
        }

        nav ul {
            list-style: none;
            display: flex;
            justify-content: center;
            gap: 2rem;
        }

        nav a {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        nav a:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        /* ===== MAIN CONTENT (From style.css) ===== */
        main {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 2.5rem;
        }

        h2 {
            color: var(--primary-color);
            margin: 2rem 0 1rem 0;
        }

        section {
            margin-bottom: 3rem;
            padding: 1.5rem;
            border: 1px solid var(--gray);
            border-radius: 8px;
            background-color: #fff;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        /* ===== FOOTER (From style.css) ===== */
        footer {
            background-color: var(--primary-color);
            color: white;
            text-align: center;
            padding: 1rem;
            margin-top: 3rem;
        }

        /* Game Specific Styles */

        #gameContainer {
            position: relative;
            width: 800px;
            height: 400px;
            border: 5px solid var(--primary-color); /* UMD Maroon Border */
            background-color: #f0f8ff; 
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
            border-radius: 8px;
            overflow: hidden; 
        }

        #gameCanvas {
            display: block;
            width: 100%;
            height: 100%;
        }

        .score-display {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--text-color);
            margin-bottom: 15px;
        }


        /* Overlay Styles (Start/Game Over) */
        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: rgba(0, 0, 0, 0.8); 
            color: white;
            z-index: 10;
            padding: 20px;
            text-align: center;
        }

        .overlay h2 {
            color: var(--secondary-color); /* UMD Gold for headings */
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .overlay p {
            font-size: 1.2rem;
            margin-bottom: 20px;
        }

        .overlay button {
            padding: 12px 25px;
            font-size: 1.2rem;
            cursor: pointer;
            background-color: var(--secondary-color); /* Gold button background */
            color: var(--primary-color); /* Maroon text */
            border: 3px solid var(--primary-color);
            border-radius: 8px;
            font-weight: bold;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 4px 0 var(--primary-color);
        }

        .overlay button:hover {
            background-color: #fff;
            transform: translateY(-2px);
            box-shadow: 0 6px 0 var(--primary-color);
        }

        /* Instructions Banner */
        .instructions-banner {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--secondary-color); 
            color: var(--primary-color);
            padding: 8px 20px;
            border-bottom-left-radius: 5px;
            border-bottom-right-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
            z-index: 20;
            font-weight: bold;
            display: none; 
            justify-content: center;
            align-items: center;
        }

        /* Responsive adjustments for smaller screens */
        @media (max-width: 850px) {
            #gameContainer {
                width: 95vw;
                height: 50vw; 
                max-height: 400px;
            }
            
            .overlay h2 {
                font-size: 2rem;
            }

            main {
                margin: 1rem auto;
                padding: 0 1rem;
            }

            h1 {
                font-size: 2rem;
            }

            .score-display {
                font-size: 1.25rem;
            }
        }

        @media (max-width: 480px) {
            #gameContainer {
                width: 98vw;
                height: 55vw;
            }

            .overlay h2 {
                font-size: 1.5rem;
            }

            .overlay p {
                font-size: 1rem;
            }

            .overlay button {
                padding: 8px 16px;
                font-size: 1rem;
            }

            h1 {
                font-size: 1.75rem;
            }

            main {
                padding: 0 0.5rem;
            }

            .score-display {
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Menu (uniform across all pages) -->
    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="hobbies.html">Hobbies</a></li>
            <li><a href="discover.html">Discover UMD</a></li>
            <li><a href="resume.html">Resume</a></li>
            <li><a href="career.html">Career</a></li>
            <li><a href="game.html">Game</a></li>
        </ul>
    </nav>

    <main>
        <h1>UMD Harbor Hopper</h1>
        <p>Jump the cargo ships and dodge the gulls in Duluth Harbor!</p>
        
        <!-- Score Display -->
        <div id="scoreContainer">
             <p id="score" class="score-display">Score: 0</p>
        </div>

        <div id="gameContainer">
            <canvas id="gameCanvas" width="800" height="400"></canvas>
            
            <!-- Start Screen Overlay -->
            <div id="startScreen" class="overlay">
                <h2>Ready to Hop?</h2>
                <p>Use **Spacebar** or **Click** to jump (you have a triple jump!).</p>
                <button onclick="startGame()">Start Game</button>
            </div>

            <!-- Instructions Overlay (Briefly shown after start) -->
            <div id="instructions" class="instructions-banner">
                <p>Jump: **Spacebar** or **Click**! Triple Jump Active!</p>
            </div>
            
            <!-- Game Over Screen Overlay -->
            <div id="gameOver" class="overlay" style="display: none;">
                <h2>GAME OVER!</h2>
                <p>Final Score: <span id="finalScore">0</span></p>
                <button onclick="restartGame()">Play Again</button>
            </div>
        </div>
        
        <p class="footer-note">5 | MIS 2201 Semester Project Guide | UMD Fall 2025</p>
    </main>

    <!-- Footer (uniform across all pages) -->
    <footer>
        <p>&copy; 2025 Your Name. All rights reserved.</p>
    </footer>
    
    <!-- CONSOLIDATED GAME SCRIPT (JAVASCRIPT) -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Game variables
            const canvas = document.getElementById('gameCanvas');
            // Check if canvas exists before getting context
            if (!canvas) {
                console.error("Canvas element 'gameCanvas' not found. Cannot initialize game.");
                return;
            }
            const ctx = canvas.getContext('2d');

            let gameState = 'start'; // 'start', 'playing', 'gameOver'
            let score = 0;
            let gameSpeed = 5; // Game speed (Issue 1 fix)
            let cameraX = 0;

            // Player object (Fish)
            const player = {
                x: 100,
                y: 300,
                width: 30,
                height: 30,
                velocityY: 0,
                isJumping: false,
                canDoubleJump: true,
                canTripleJump: true,
                color: '#ff6b6b'
            };

            // Game objects
            let obstacles = [];
            let particles = [];
            let backgroundObjects = [];
            let birdPredators = []; 

            // Physics constants
            const GRAVITY = 0.5;
            const JUMP_FORCE = -13;
            const GROUND_Y = 350;

            // Initialize background objects - Only Clouds remain in the sky
            function initBackground() {
                backgroundObjects = [];
                
                // Add clouds (The only remaining permanent sky object, per request)
                for (let i = 0; i < 5; i++) {
                    backgroundObjects.push({
                        x: i * 200 + Math.random() * 100,
                        y: Math.random() * 80 + 20,
                        width: Math.random() * 50 + 100,
                        height: Math.random() * 10 + 20,
                        type: 'cloud',
                        color: '#FFFFFF'
                    });
                }
            }

            // Create obstacle - Duluth harbor themed (Only water-based, collidable obstacles)
            function createObstacle() {
                const types = ['boat', 'sailboat', 'buoy', 'tugboat', 'fishing_boat'];
                const type = types[Math.floor(Math.random() * types.length)];

                let obstacle = {
                    x: canvas.width + 100,
                    y: GROUND_Y,
                    width: 40,
                    height: 50,
                    type: type,
                    color: '#2c3e50',
                    isMoving: false,
                    moveSpeed: 0,
                    moveDirection: 1
                };

                if (type === 'boat') {
                    obstacle.width = 120; // Wider for a cargo ship look
                    obstacle.height = 30; 
                    obstacle.y = GROUND_Y + 10;
                    obstacle.color = '#464a4d'; // Dark gray/steel
                    obstacle.isMoving = Math.random() < 0.3;
                    obstacle.moveSpeed = 0.5;
                } else if (type === 'sailboat') {
                    obstacle.width = 60;
                    obstacle.height = 20;
                    obstacle.y = GROUND_Y + 20;
                    obstacle.color = '#8b4513';
                    obstacle.isMoving = Math.random() < 0.4;
                    obstacle.moveSpeed = 0.3;
                } else if (type === 'buoy') {
                    obstacle.width = 20;
                    obstacle.height = 30;
                    obstacle.y = GROUND_Y + 10;
                    obstacle.color = '#ff6b6b';
                    obstacle.isMoving = Math.random() < 0.2;
                    obstacle.moveSpeed = 0.2;
                } else if (type === 'tugboat') {
                    obstacle.width = 70;
                    obstacle.height = 20;
                    obstacle.y = GROUND_Y + 18;
                    obstacle.color = '#FF5733'; // Orange-Red
                    obstacle.isMoving = Math.random() < 0.4;
                    obstacle.moveSpeed = 0.4;
                } else if (type === 'fishing_boat') {
                    obstacle.width = 90;
                    obstacle.height = 22;
                    obstacle.y = GROUND_Y + 16;
                    obstacle.color = '#0000FF';
                    obstacle.isMoving = Math.random() < 0.3;
                    obstacle.moveSpeed = 0.3;
                }

                obstacles.push(obstacle);
            }

            // Create Bird Predator 
            function createBirdPredator() {
                birdPredators.push({
                    x: canvas.width + 100,
                    y: Math.random() * 100 + 50, // High in the sky
                    width: 40,
                    height: 20,
                    color: '#694017', 
                    wingAngle: 0, 
                    wingSpeed: 0.2, 
                    verticalDirection: Math.random() < 0.5 ? 1 : -1, 
                    verticalSpeed: Math.random() * 0.5 + 0.5 
                });
            }

            // Particle functions
            function createParticles(x, y, color) {
                for (let i = 0; i < 10; i++) {
                    particles.push({
                        x: x,
                        y: y,
                        velocityX: (Math.random() - 0.5) * 10,
                        velocityY: (Math.random() - 0.5) * 10,
                        life: 30,
                        maxLife: 30,
                        color: color,
                        size: Math.random() * 4 + 2
                    });
                }
            }

            // Jump function (Triple Jump fix included)
            function jump() {
                if (gameState !== 'playing') return;

                if (!player.isJumping) {
                    player.velocityY = JUMP_FORCE;
                    player.isJumping = true;
                    player.canDoubleJump = true;
                    player.canTripleJump = true;
                } else if (player.canDoubleJump && player.velocityY > -3) {
                    player.velocityY = JUMP_FORCE * 0.9;
                    player.canDoubleJump = false;
                } else if (player.canTripleJump && player.velocityY > -1) {
                    player.velocityY = JUMP_FORCE * 0.8;
                    player.canTripleJump = false;
                }
            }

            // Update functions for Player, Obstacles, Birds, Particles, Collisions, Game State
            function updatePlayer() {
                if (gameState !== 'playing') return;

                player.velocityY += GRAVITY;
                player.y += player.velocityY;

                if (player.y >= GROUND_Y) {
                    player.y = GROUND_Y;
                    player.velocityY = 0;
                    player.isJumping = false;
                    player.canDoubleJump = true; 
                    player.canTripleJump = true; 
                }
            }

            function updateObstacles() {
                if (gameState !== 'playing') return;

                obstacles.forEach(obstacle => {
                    obstacle.x -= gameSpeed;

                    if (obstacle.isMoving) {
                        obstacle.y += obstacle.moveSpeed * obstacle.moveDirection;

                        if (obstacle.y >= GROUND_Y + 25 || obstacle.y <= GROUND_Y - 5) {
                            obstacle.moveDirection *= -1;
                        }
                    }
                });

                const obstaclesBefore = obstacles.length;
                obstacles = obstacles.filter(obstacle => obstacle.x > -obstacle.width);
                const obstaclesAfter = obstacles.length;

                if (obstaclesBefore > obstaclesAfter) {
                    score += 10;
                }

                if (Math.random() < 0.015) {
                    createObstacle();
                }

                gameSpeed += 0.001;
            }

            function updateBirdPredators() {
                if (gameState !== 'playing') return;

                birdPredators.forEach(bird => {
                    bird.x -= gameSpeed * 1.5; 
                    bird.y += bird.verticalSpeed * bird.verticalDirection;

                    bird.wingAngle = Math.sin(Date.now() * bird.wingSpeed) * 0.5;

                    if (bird.y <= 50 || bird.y >= 150) {
                        bird.verticalDirection *= -1;
                    }
                });

                birdPredators = birdPredators.filter(bird => bird.x > -bird.width * 2);

                if (Math.random() < 0.008) {
                    createBirdPredator();
                }
            }

            function updateParticles() {
                particles.forEach(particle => {
                    particle.x += particle.velocityX;
                    particle.y += particle.velocityY;
                    particle.velocityY += 0.3; 
                    particle.life--;
                });

                particles = particles.filter(particle => particle.life > 0);
            }

            function checkCollisions() {
                obstacles.forEach(obstacle => {
                    if (player.x < obstacle.x + obstacle.width &&
                        player.x + player.width > obstacle.x &&
                        player.y < obstacle.y + obstacle.height &&
                        player.y + player.height > obstacle.y) {
                        gameOver();
                    }
                });

                birdPredators.forEach(bird => {
                    if (player.x < bird.x + bird.width &&
                        player.x + player.width > bird.x &&
                        player.y < bird.y + bird.height &&
                        player.y + player.height > bird.y) {
                        gameOver();
                    }
                });
            }

            function gameOver() {
                gameState = 'gameOver';
                document.getElementById('gameOver').style.display = 'flex'; // Use flex for centering
                document.getElementById('finalScore').textContent = Math.floor(score); 
                createParticles(player.x + player.width/2, player.y + player.height/2, player.color);
            }

            function startGame() {
                gameState = 'playing';
                document.getElementById('startScreen').style.display = 'none';
                document.getElementById('instructions').style.display = 'flex'; // Use flex for banner
                document.getElementById('gameOver').style.display = 'none';

                setTimeout(() => {
                    document.getElementById('instructions').style.display = 'none';
                }, 3000);

                resetGame();
            }

            function restartGame() {
                document.getElementById('gameOver').style.display = 'none';
                document.getElementById('startScreen').style.display = 'flex'; // Show start screen again
                document.getElementById('instructions').style.display = 'none';
                resetGame();
            }

            function resetGame() {
                score = 0;
                gameSpeed = 5; 
                cameraX = 0;
                player.x = 100;
                player.y = 300;
                player.velocityY = 0;
                player.isJumping = false;
                player.canDoubleJump = true;
                player.canTripleJump = true;
                obstacles = [];
                particles = [];
                birdPredators = [];
                initBackground();
            }

            // Draw functions
            function drawBackground() {
                // Duluth harbor sky gradient
                const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
                gradient.addColorStop(0, '#87CEEB'); 
                gradient.addColorStop(0.3, '#B0E0E6'); 
                gradient.addColorStop(0.7, '#4682B4'); 
                gradient.addColorStop(1, '#2F4F4F'); 
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // Background objects - Only Clouds remain
                backgroundObjects.forEach(obj => {
                    const parallaxSpeed = 0.1; 
                    const objX = obj.x - cameraX * parallaxSpeed;

                    if (obj.type === 'cloud') {
                        // Draw simple, soft cloud shapes
                        ctx.fillStyle = obj.color;
                        ctx.beginPath();
                        ctx.arc(objX, obj.y, obj.width / 4, 0, 2 * Math.PI);
                        ctx.arc(objX + obj.width / 4, obj.y - 10, obj.width / 4, 0, 2 * Math.PI);
                        ctx.arc(objX + obj.width / 2, obj.y, obj.width / 4, 0, 2 * Math.PI);
                        ctx.fill();
                    }
                });

                // Water surface
                ctx.fillStyle = '#4682B4';
                ctx.fillRect(0, GROUND_Y, canvas.width, canvas.height - GROUND_Y);

                // Water waves 
                ctx.strokeStyle = '#5F9EA0';
                ctx.lineWidth = 2;
                for (let i = 0; i < canvas.width; i += 20) {
                    ctx.beginPath();
                    ctx.moveTo(i, GROUND_Y + Math.sin((i + cameraX * 0.3) * 0.1) * 5); 
                    ctx.lineTo(i + 20, GROUND_Y + Math.sin((i + 20 + cameraX * 0.3) * 0.1) * 5);
                    ctx.stroke();
                }
            }

            function drawPlayer() {
                // Draw fish character
                ctx.fillStyle = '#ff6b6b';
                ctx.beginPath();
                ctx.ellipse(player.x + player.width/2, player.y + player.height/2, player.width/2, player.height/2, 0, 0, 2 * Math.PI);
                ctx.fill();

                // Fish tail
                ctx.fillStyle = '#ff6b6b';
                ctx.beginPath();
                ctx.moveTo(player.x, player.y + player.height/2);
                ctx.lineTo(player.x - 15, player.y + 5);
                ctx.lineTo(player.x - 15, player.y + player.height - 5);
                ctx.closePath();
                ctx.fill();

                // Fish eye
                ctx.fillStyle = 'white';
                ctx.beginPath();
                ctx.arc(player.x + player.width/2 + 5, player.y + player.height/2 - 5, 6, 0, 2 * Math.PI);
                ctx.fill();

                ctx.fillStyle = 'black';
                ctx.beginPath();
                ctx.arc(player.x + player.width/2 + 7, player.y + player.height/2 - 3, 3, 0, 2 * Math.PI);
                ctx.fill();
            }

            function drawBird(bird) {
                ctx.save();
                ctx.translate(bird.x + bird.width / 2, bird.y + bird.height / 2);
                ctx.fillStyle = bird.color;

                // Draw body (Simple oval)
                ctx.beginPath();
                ctx.ellipse(0, 0, bird.width / 2, bird.height / 2, 0, 0, 2 * Math.PI);
                ctx.fill();

                // Draw beak
                ctx.fillStyle = '#ffd700'; 
                ctx.beginPath();
                ctx.moveTo(bird.width / 2, 0);
                ctx.lineTo(bird.width / 2 + 5, -3);
                ctx.lineTo(bird.width / 2, 3);
                ctx.closePath();
                ctx.fill();

                // Draw wings (Flapping animation)
                ctx.fillStyle = bird.color;

                // Right wing
                ctx.save();
                ctx.rotate(-bird.wingAngle);
                ctx.beginPath();
                ctx.moveTo(0, 0);
                ctx.lineTo(20, -20);
                ctx.lineTo(40, -10);
                ctx.lineTo(20, 0);
                ctx.closePath();
                ctx.fill();
                ctx.restore();

                // Left wing
                ctx.save();
                ctx.rotate(bird.wingAngle);
                ctx.beginPath();
                ctx.moveTo(0, 0);
                ctx.lineTo(20, 20);
                ctx.lineTo(40, 10);
                ctx.lineTo(20, 0);
                ctx.closePath();
                ctx.fill();
                ctx.restore();

                ctx.restore();
            }

            function drawObstacles() {
                obstacles.forEach(obstacle => {
                    ctx.fillStyle = obstacle.color;

                    if (obstacle.type === 'boat') {
                        // Draw CARGO SHIP Obstacle Hull 
                        const hullColor = obstacle.color; 
                        const deckColor = '#607d8b'; 

                        // Hull (submerged part)
                        ctx.fillStyle = hullColor;
                        ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);

                        // Waterline Stripe
                        ctx.fillStyle = '#a94442'; // Rust red
                        ctx.fillRect(obstacle.x, obstacle.y + obstacle.height * 0.8, obstacle.width, obstacle.height * 0.2);

                        // Deck
                        ctx.fillStyle = deckColor;
                        ctx.fillRect(obstacle.x, obstacle.y - 5, obstacle.width, 5);
                        
                        // Superstructure/Cabin (near the stern)
                        ctx.fillStyle = '#FFFFFF';
                        ctx.fillRect(obstacle.x + obstacle.width - 30, obstacle.y - 15, 25, 10);
                        

                    } else if (obstacle.type === 'sailboat') {
                        // Draw realistic SAILBOAT
                        ctx.fillStyle = '#8B4513';
                        ctx.beginPath();
                        // Hull shape 
                        ctx.moveTo(obstacle.x, obstacle.y + obstacle.height);
                        ctx.lineTo(obstacle.x + obstacle.width, obstacle.y + obstacle.height);
                        ctx.lineTo(obstacle.x + obstacle.width * 0.9, obstacle.y);
                        ctx.lineTo(obstacle.x + obstacle.width * 0.1, obstacle.y);
                        ctx.closePath();
                        ctx.fill();

                        // Mast
                        ctx.fillStyle = '#8B4513';
                        ctx.fillRect(obstacle.x + obstacle.width / 2 - 1, obstacle.y - 50, 2, 50);

                        // Main Sail (white triangular sail)
                        ctx.fillStyle = '#FFFFFF';
                        ctx.beginPath();
                        ctx.moveTo(obstacle.x + obstacle.width / 2, obstacle.y - 50);
                        ctx.lineTo(obstacle.x + obstacle.width * 0.9, obstacle.y - 5);
                        ctx.lineTo(obstacle.x + obstacle.width / 2, obstacle.y - 5); 
                        ctx.closePath();
                        ctx.fill();

                    } else if (obstacle.type === 'buoy') {
                        // Draw buoy
                        ctx.fillStyle = '#FF0000';
                        ctx.beginPath();
                        ctx.arc(obstacle.x + obstacle.width / 2, obstacle.y + obstacle.height / 2, obstacle.width / 2, 0, 2 * Math.PI);
                        ctx.fill();

                        ctx.fillStyle = '#FFFFFF';
                        ctx.fillRect(obstacle.x + 2, obstacle.y + obstacle.height / 2 - 3, obstacle.width - 4, 6);

                    } else if (obstacle.type === 'tugboat') {
                        // Draw realistic TUG BOAT
                        const tugColor = obstacle.color; // Orange-Red
                        const cabinColor = '#FFC300'; // Yellow Cabin

                        // Hull
                        ctx.fillStyle = tugColor;
                        ctx.beginPath();
                        ctx.moveTo(obstacle.x, obstacle.y + obstacle.height);
                        ctx.lineTo(obstacle.x + obstacle.width, obstacle.y + obstacle.height);
                        ctx.lineTo(obstacle.x + obstacle.width, obstacle.y);
                        ctx.lineTo(obstacle.x, obstacle.y);
                        ctx.closePath();
                        ctx.fill();

                        // Deck
                        ctx.fillStyle = '#333';
                        ctx.fillRect(obstacle.x, obstacle.y - 5, obstacle.width, 5);
                        
                        // Cabin/Bridge (Taller and set back)
                        ctx.fillStyle = cabinColor;
                        ctx.fillRect(obstacle.x + 15, obstacle.y - 35, obstacle.width - 30, 30);
                        
                        // Smokestack
                        ctx.fillStyle = '#333';
                        ctx.fillRect(obstacle.x + obstacle.width - 20, obstacle.y - 45, 10, 10);

                    } else if (obstacle.type === 'fishing_boat') {
                        // Draw fishing boat
                        ctx.fillStyle = obstacle.color;
                        ctx.beginPath();
                        // Hull (slightly curved bow/stern)
                        ctx.moveTo(obstacle.x, obstacle.y + obstacle.height);
                        ctx.quadraticCurveTo(obstacle.x + obstacle.width / 2, obstacle.y + obstacle.height + 5, obstacle.x + obstacle.width, obstacle.y + obstacle.height);
                        ctx.lineTo(obstacle.x + obstacle.width, obstacle.y - 5);
                        ctx.lineTo(obstacle.x, obstacle.y - 5);
                        ctx.closePath();
                        ctx.fill();

                        // Deck
                        ctx.fillStyle = '#8B4513';
                        ctx.fillRect(obstacle.x, obstacle.y - 5, obstacle.width, 5);

                        // Cabin
                        ctx.fillStyle = '#FFFFFF';
                        ctx.fillRect(obstacle.x + 10, obstacle.y - 15, obstacle.width - 20, 10);
                    }
                });
            }

            function drawParticles() {
                particles.forEach(particle => {
                    const alpha = particle.life / particle.maxLife;
                    ctx.globalAlpha = alpha;
                    ctx.fillStyle = particle.color;
                    ctx.fillRect(particle.x, particle.y, particle.size, particle.size);
                });
                ctx.globalAlpha = 1;
            }

            function drawUI() {
                // Score
                const scoreElement = document.getElementById('score');
                if (scoreElement) {
                    scoreElement.textContent = `Score: ${Math.floor(score)}`;
                }
            }

            // Main game loop
            function gameLoop() {
                // Clear canvas
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // Draw background
                drawBackground();

                if (gameState === 'playing') {
                    // Update game objects
                    updatePlayer();
                    updateObstacles();
                    updateBirdPredators(); 
                    updateParticles();
                    checkCollisions();

                    // Update camera
                    cameraX += gameSpeed;
                }

                // Draw game objects
                drawPlayer();
                drawObstacles();
                birdPredators.forEach(drawBird); 
                drawParticles();
                drawUI();

                // Continue game loop
                requestAnimationFrame(gameLoop);
            }

            // Event listeners
            document.addEventListener('keydown', (e) => {
                if (e.code === 'Space') {
                    e.preventDefault();
                    jump();
                }
            });

            canvas.addEventListener('click', () => {
                jump();
            });

            // Expose functions globally for HTML buttons to call
            window.startGame = startGame;
            window.restartGame = restartGame;

            // Initialize game on load
            initBackground();
            gameLoop();
        });
    </script>
</body>
</html>
